// Version 1.1.8 three-geojson-geometry - https://github.com/vasturiano/three-geojson-geometry
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).THREE=t.THREE||{},t.THREE)}(this,(function(t,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function r(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},o(t)}function i(t,n){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},i(t,n)}function u(t,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=o(t);if(n){var i=o(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return u(this,e)}}function f(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,o,i=[],u=!0,a=!1;try{for(e=e.call(t);!(u=(r=e.next()).done)&&(i.push(r.value),!n||i.length!==n);u=!0);}catch(t){a=!0,o=t}finally{try{u||null==e.return||e.return()}finally{if(a)throw o}}return i}(t,n)||c(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,n){if(t){if("string"==typeof t)return l(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?l(t,n):void 0}}function l(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var s={exports:{}};function v(t,n,e){e=e||2;var r,o,i,u,a,f,c,l=n&&n.length,s=l?n[0]*e:t.length,v=x(t,0,s,e,!0),p=[];if(!v||v.next===v.prev)return p;if(l&&(v=function(t,n,e,r){var o,i,u,a=[];for(o=0,i=n.length;o<i;o++)(u=x(t,n[o]*r,o<i-1?n[o+1]*r:t.length,r,!1))===u.next&&(u.steiner=!0),a.push(Z(u));for(a.sort(m),o=0;o<a.length;o++)e=w(a[o],e);return e}(t,n,v,e)),t.length>80*e){r=i=t[0],o=u=t[1];for(var y=e;y<s;y+=e)(a=t[y])<r&&(r=a),(f=t[y+1])<o&&(o=f),a>i&&(i=a),f>u&&(u=f);c=0!==(c=Math.max(i-r,u-o))?32767/c:0}return h(v,p,e,r,o,c,0),p}function x(t,n,e,r,o){var i,u;if(o===F(t,n,e,r)>0)for(i=n;i<e;i+=r)u=I(i,t[i],t[i+1],u);else for(i=e-r;i>=n;i-=r)u=I(i,t[i],t[i+1],u);return u&&j(u,u.next)&&(z(u),u=u.next),u}function p(t,n){if(!t)return t;n||(n=t);var e,r=t;do{if(e=!1,r.steiner||!j(r,r.next)&&0!==S(r.prev,r,r.next))r=r.next;else{if(z(r),(r=n=r.prev)===r.next)break;e=!0}}while(e||r!==n);return n}function h(t,n,e,r,o,i,u){if(t){!u&&i&&function(t,n,e,r){var o=t;do{0===o.z&&(o.z=E(o.x,o.y,n,e,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var n,e,r,o,i,u,a,f,c=1;do{for(e=t,t=null,i=null,u=0;e;){for(u++,r=e,a=0,n=0;n<c&&(a++,r=r.nextZ);n++);for(f=c;a>0||f>0&&r;)0!==a&&(0===f||!r||e.z<=r.z)?(o=e,e=e.nextZ,a--):(o=r,r=r.nextZ,f--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;e=r}i.nextZ=null,c*=2}while(u>1)}(o)}(t,r,o,i);for(var a,f,c=t;t.prev!==t.next;)if(a=t.prev,f=t.next,i?d(t,r,o,i):y(t))n.push(a.i/e|0),n.push(t.i/e|0),n.push(f.i/e|0),z(t),t=f.next,c=f.next;else if((t=f)===c){u?1===u?h(t=g(p(t),n,e),n,e,r,o,i,2):2===u&&b(t,n,e,r,o,i):h(p(t),n,e,r,o,i,1);break}}}function y(t){var n=t.prev,e=t,r=t.next;if(S(n,e,r)>=0)return!1;for(var o=n.x,i=e.x,u=r.x,a=n.y,f=e.y,c=r.y,l=o<i?o<u?o:u:i<u?i:u,s=a<f?a<c?a:c:f<c?f:c,v=o>i?o>u?o:u:i>u?i:u,x=a>f?a>c?a:c:f>c?f:c,p=r.next;p!==n;){if(p.x>=l&&p.x<=v&&p.y>=s&&p.y<=x&&P(o,a,i,f,u,c,p.x,p.y)&&S(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function d(t,n,e,r){var o=t.prev,i=t,u=t.next;if(S(o,i,u)>=0)return!1;for(var a=o.x,f=i.x,c=u.x,l=o.y,s=i.y,v=u.y,x=a<f?a<c?a:c:f<c?f:c,p=l<s?l<v?l:v:s<v?s:v,h=a>f?a>c?a:c:f>c?f:c,y=l>s?l>v?l:v:s>v?s:v,d=E(x,p,n,e,r),g=E(h,y,n,e,r),b=t.prevZ,m=t.nextZ;b&&b.z>=d&&m&&m.z<=g;){if(b.x>=x&&b.x<=h&&b.y>=p&&b.y<=y&&b!==o&&b!==u&&P(a,l,f,s,c,v,b.x,b.y)&&S(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,m.x>=x&&m.x<=h&&m.y>=p&&m.y<=y&&m!==o&&m!==u&&P(a,l,f,s,c,v,m.x,m.y)&&S(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;b&&b.z>=d;){if(b.x>=x&&b.x<=h&&b.y>=p&&b.y<=y&&b!==o&&b!==u&&P(a,l,f,s,c,v,b.x,b.y)&&S(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;m&&m.z<=g;){if(m.x>=x&&m.x<=h&&m.y>=p&&m.y<=y&&m!==o&&m!==u&&P(a,l,f,s,c,v,m.x,m.y)&&S(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function g(t,n,e){var r=t;do{var o=r.prev,i=r.next.next;!j(o,i)&&_(o,r,r.next,i)&&R(o,i)&&R(i,o)&&(n.push(o.i/e|0),n.push(r.i/e|0),n.push(i.i/e|0),z(r),z(r.next),r=t=i),r=r.next}while(r!==t);return p(r)}function b(t,n,e,r,o,i){var u=t;do{for(var a=u.next.next;a!==u.prev;){if(u.i!==a.i&&O(u,a)){var f=G(u,a);return u=p(u,u.next),f=p(f,f.next),h(u,n,e,r,o,i,0),void h(f,n,e,r,o,i,0)}a=a.next}u=u.next}while(u!==t)}function m(t,n){return t.x-n.x}function w(t,n){var e=function(t,n){var e,r=n,o=t.x,i=t.y,u=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=o&&a>u&&(u=a,e=r.x<r.next.x?r:r.next,a===o))return e}r=r.next}while(r!==n);if(!e)return null;var f,c=e,l=e.x,s=e.y,v=1/0;r=e;do{o>=r.x&&r.x>=l&&o!==r.x&&P(i<s?o:u,i,l,s,i<s?u:o,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(o-r.x),R(r,t)&&(f<v||f===v&&(r.x>e.x||r.x===e.x&&M(e,r)))&&(e=r,v=f)),r=r.next}while(r!==c);return e}(t,n);if(!e)return n;var r=G(e,t);return p(r,r.next),p(e,e.next)}function M(t,n){return S(t.prev,t,n.prev)<0&&S(n.next,t,t.next)<0}function E(t,n,e,r,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-e)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-r)*o|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Z(t){var n=t,e=t;do{(n.x<e.x||n.x===e.x&&n.y<e.y)&&(e=n),n=n.next}while(n!==t);return e}function P(t,n,e,r,o,i,u,a){return(o-u)*(n-a)>=(t-u)*(i-a)&&(t-u)*(r-a)>=(e-u)*(n-a)&&(e-u)*(i-a)>=(o-u)*(r-a)}function O(t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!function(t,n){var e=t;do{if(e.i!==t.i&&e.next.i!==t.i&&e.i!==n.i&&e.next.i!==n.i&&_(e,e.next,t,n))return!0;e=e.next}while(e!==t);return!1}(t,n)&&(R(t,n)&&R(n,t)&&function(t,n){var e=t,r=!1,o=(t.x+n.x)/2,i=(t.y+n.y)/2;do{e.y>i!=e.next.y>i&&e.next.y!==e.y&&o<(e.next.x-e.x)*(i-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next}while(e!==t);return r}(t,n)&&(S(t.prev,t,n.prev)||S(t,n.prev,n))||j(t,n)&&S(t.prev,t,t.next)>0&&S(n.prev,n,n.next)>0)}function S(t,n,e){return(n.y-t.y)*(e.x-n.x)-(n.x-t.x)*(e.y-n.y)}function j(t,n){return t.x===n.x&&t.y===n.y}function _(t,n,e,r){var o=T(S(t,n,e)),i=T(S(t,n,r)),u=T(S(e,r,t)),a=T(S(e,r,n));return o!==i&&u!==a||(!(0!==o||!A(t,e,n))||(!(0!==i||!A(t,r,n))||(!(0!==u||!A(e,t,r))||!(0!==a||!A(e,n,r)))))}function A(t,n,e){return n.x<=Math.max(t.x,e.x)&&n.x>=Math.min(t.x,e.x)&&n.y<=Math.max(t.y,e.y)&&n.y>=Math.min(t.y,e.y)}function T(t){return t>0?1:t<0?-1:0}function R(t,n){return S(t.prev,t,t.next)<0?S(t,n,t.next)>=0&&S(t,t.prev,n)>=0:S(t,n,t.prev)<0||S(t,t.next,n)<0}function G(t,n){var e=new B(t.i,t.x,t.y),r=new B(n.i,n.x,n.y),o=t.next,i=n.prev;return t.next=n,n.prev=t,e.next=o,o.prev=e,r.next=e,e.prev=r,i.next=r,r.prev=i,r}function I(t,n,e,r){var o=new B(t,n,e);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function z(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function B(t,n,e){this.i=t,this.x=n,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function F(t,n,e,r){for(var o=0,i=n,u=e-r;i<e;i+=r)o+=(t[u]-t[i])*(t[i+1]+t[u+1]),u=i;return o}s.exports=v,s.exports.default=v,v.deviation=function(t,n,e,r){var o=n&&n.length,i=o?n[0]*e:t.length,u=Math.abs(F(t,0,i,e));if(o)for(var a=0,f=n.length;a<f;a++){var c=n[a]*e,l=a<f-1?n[a+1]*e:t.length;u-=Math.abs(F(t,c,l,e))}var s=0;for(a=0;a<r.length;a+=3){var v=r[a]*e,x=r[a+1]*e,p=r[a+2]*e;s+=Math.abs((t[v]-t[p])*(t[x+1]-t[v+1])-(t[v]-t[x])*(t[p+1]-t[v+1]))}return 0===u&&0===s?0:Math.abs((s-u)/u)},v.flatten=function(t){for(var n=t[0][0].length,e={vertices:[],holes:[],dimensions:n},r=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var u=0;u<n;u++)e.vertices.push(t[o][i][u]);o>0&&(r+=t[o-1].length,e.holes.push(r))}return e};class H{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const o=n[r],i=t+o,u=Math.abs(t)<Math.abs(o)?t-(i-o):o-(i-t);u&&(n[e++]=u),t=i}return n[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let n,e,r,o=this._n,i=0;if(o>0){for(i=t[--o];o>0&&(n=i,e=t[--o],i=n+e,r=e-(i-n),!r););o>0&&(r<0&&t[o-1]<0||r>0&&t[o-1]>0)&&(e=2*r,n=i+e,e==n-i&&(i=n))}return i}}var L=Math.PI,C=L/2,k=180/L,J=L/180,q=Math.abs,D=Math.atan2,U=Math.cos,$=Math.sin,K=Math.sqrt;function N(t){return(t=$(t/2))*t}function Q(){}function V(t,n){t&&et.hasOwnProperty(t.type)&&et[t.type](t,n)}var W,X,Y,tt,nt={Feature:function(t,n){V(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,o=e.length;++r<o;)V(e[r].geometry,n)}},et={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){rt(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)rt(e[r],n,0)},Polygon:function(t,n){ot(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)ot(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,o=e.length;++r<o;)V(e[r],n)}};function rt(t,n,e){var r,o=-1,i=t.length-e;for(n.lineStart();++o<i;)r=t[o],n.point(r[0],r[1],r[2]);n.lineEnd()}function ot(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)rt(t[e],n,1);n.polygonEnd()}var it={sphere:Q,point:Q,lineStart:function(){it.point=at,it.lineEnd=ut},lineEnd:Q,polygonStart:Q,polygonEnd:Q};function ut(){it.point=it.lineEnd=Q}function at(t,n){X=t*=J,Y=$(n*=J),tt=U(n),it.point=ft}function ft(t,n){t*=J;var e=$(n*=J),r=U(n),o=q(t-X),i=U(o),u=r*$(o),a=tt*e-Y*r*i,f=Y*e+tt*r*i;W.add(D(K(u*u+a*a),f)),X=t,Y=e,tt=r}function ct(t){return W=new H,function(t,n){t&&nt.hasOwnProperty(t.type)?nt[t.type](t,n):V(t,n)}(t,it),+W}var lt=[null,null],st={type:"LineString",coordinates:lt};function vt(t,n){return lt[0]=t,lt[1]=n,ct(st)}function xt(t,n){var e,r=t[0]*J,o=t[1]*J,i=n[0]*J,u=n[1]*J,a=U(o),f=$(o),c=U(u),l=$(u),s=a*U(r),v=a*$(r),x=c*U(i),p=c*$(i),h=2*((e=K(N(u-o)+a*c*N(i-r)))>1?C:e<-1?-C:Math.asin(e)),y=$(h),d=h?function(t){var n=$(t*=h)/y,e=$(h-t)/y,r=e*s+n*x,o=e*v+n*p,i=e*f+n*l;return[D(o,r)*k,D(i,K(r*r+o*o))*k]}:function(){return[r*k,o*k]};return d.distance=h,d}var pt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=[],r=null;return t.forEach((function(t){if(r){var o=180*vt(t,r)/Math.PI;if(o>n)for(var i=xt(r,t),u=1/Math.ceil(o/n),a=u;a<1;)e.push(i(a)),a+=u}e.push(r=t)})),e},ht="undefined"!=typeof window&&window.THREE?window.THREE:{BufferGeometry:n.BufferGeometry,Float32BufferAttribute:n.Float32BufferAttribute},yt=(new ht.BufferGeometry).setAttribute?"setAttribute":"addAttribute",dt=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&i(t,n)}(l,t);var n,o,u,c=a(l);function l(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;e(this,l),(n=c.call(this)).type="GeoJsonGeometry",n.parameters={geoJson:t,radius:r,resolution:o};var i=({Point:x,MultiPoint:p,LineString:h,MultiLineString:y,Polygon:d,MultiPolygon:g}[t.type]||function(){return[]})(t.coordinates,r),u=[],a=[],v=0;function x(t,n){return[{vertices:mt(t[1],t[0],n),indices:[]}]}function p(t,n){var e={vertices:[],indices:[]};return t.map((function(t){return x(t,n)})).forEach((function(t){var n=f(t,1)[0];gt(e,n)})),[e]}function h(t,n){for(var e=pt(t,o).map((function(t){var e=f(t,2),r=e[0];return mt(e[1],r,n)})),r=s.exports.flatten([e]).vertices,i=Math.round(r.length/3),u=[],a=1;a<i;a++)u.push(a-1,a);return[{vertices:r,indices:u}]}function y(t,n){var e={vertices:[],indices:[]};return t.map((function(t){return h(t,n)})).forEach((function(t){var n=f(t,1)[0];gt(e,n)})),[e]}function d(t,n){for(var e=t.map((function(t){return pt(t,o).map((function(t){var e=f(t,2),r=e[0];return mt(e[1],r,n)}))})),r=s.exports.flatten(e),i=r.vertices,u=r.holes,a=u[0]||1/0,c=i.slice(0,3*a),l=i.slice(3*a),v=new Set(u),x=Math.round(i.length/3),p=[],h=[],y=1;y<x;y++)v.has(y)||(y<a?p.push(y-1,y):h.push(y-1-a,y-a));var d=[{indices:p,vertices:c}];return u.length&&d.push({indices:h,vertices:l}),d}function g(t,n){var e={vertices:[],indices:[]},r={vertices:[],indices:[]};t.map((function(t){return d(t,n)})).forEach((function(t){var n=f(t,2),o=n[0],i=n[1];gt(e,o),i&&gt(r,i)}));var o=[e];return r.vertices.length&&o.push(r),o}return i.forEach((function(t){var e=u.length;gt({indices:u,vertices:a},t),n.addGroup(e,u.length-e,v++)})),u.length&&n.setIndex(u),a.length&&n[yt]("position",new ht.Float32BufferAttribute(a,3)),n}return n=l,o&&r(n.prototype,o),u&&r(n,u),Object.defineProperty(n,"prototype",{writable:!1}),n}(ht.BufferGeometry);function gt(t,n){var e=Math.round(t.vertices.length/3);bt(t.vertices,n.vertices),bt(t.indices,n.indices.map((function(t){return t+e})))}function bt(t,n){var e,r=function(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=c(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==e.return||e.return()}finally{if(a)throw i}}}}(n);try{for(r.s();!(e=r.n()).done;){var o=e.value;t.push(o)}}catch(t){r.e(t)}finally{r.f()}}function mt(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(90-t)*Math.PI/180,o=(90-n)*Math.PI/180;return[e*Math.sin(r)*Math.cos(o),e*Math.cos(r),e*Math.sin(r)*Math.sin(o)]}t.GeoJsonGeometry=dt,Object.defineProperty(t,"__esModule",{value:!0})}));
